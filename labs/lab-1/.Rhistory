#pl1 <- pl1 + geom_vline(xintercept = num_events, colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value))
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
#pl1 <- pl1 + geom_vline(xintercept = num_events, colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl <- ggplot(d, aes(x=t, y=value, color=type)) + geom_point(size=0.1)
pl <- pl + geom_line(size=0.6)
pl <- pl + scale_color_manual(values=c("#4daf4a", "#377eb8"), labels=c("# of STB Tuning In", "# of STB Tuning Out"))
pl <- pl + theme2
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl <- pl + geom_vline(xintercept = num_events, colour = "grey70", size = 0.6)
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- pl1 +  scale_size(labels = c("Test"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 +  scale_size(labels = c("Test"), guide="legend")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_colour_manual(name="Error Bars", values="cols")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_colour_manual(name="Error Bars", values="type")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_colour_manual(name="Error Bars", values="grey90")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- pl1 + scale_linetype_manual(values="grey70", labels="Beginning of Commercial Break")
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + scale_linetype_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + scale_linetype_manual(values="grey70", labels="Beginning of Commercial Break", guide="legend")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- pl1 + scale_shape_manual(values="grey70", labels="Beginning of Commercial Break", guide="legend")
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + scale_shape_manual(values="grey70", labels="Beginning of Commercial Break")
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_shape_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values=c("#B13C66", "grey70"), labels=c("Percentage of Audience", "Beginning of Commercial Break"))
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values=c("#B13C66", "grey70"), labels=c("Percentage of Audience", "Beginning of Commercial Break"))
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_shape_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,21),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
#pl1 <- pl1 + scale_shape_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + scale_color_manual(values=c("#B13C66", "grey70"), labels=c("Percentage of Audience", "Beginning of Commercial Break"))
pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,21),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_shape_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + scale_linetype_manual(values = c(1,0)) + scale_alpha_manual(values = c(0,1))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- pl1 + annotate("text", x = pos_events[1], y = 75)
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = pos_events[1], y = 75, label = "60%")
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = pos_events, y = c(60, 70, 80, 90, 100), c("60%", "70%", "80%", "90%", "100%"))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = rep(max(da$t, 5)), y = c(60, 70, 80, 90, 100), c("60%", "70%", "80%", "90%", "100%"))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = rep(max(as.POSIXct(t, origin = '1970-01-01'), 5)), y = c(60, 70, 80, 90, 100), c("60%", "70%", "80%", "90%", "100%"))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = rep(max(as.POSIXct(da$t, origin = '1970-01-01'), 5)), y = c(60, 70, 80, 90, 100), c("60%", "70%", "80%", "90%", "100%"))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
max(as.POSIXct(da$t, origin = '1970-01-01')
)
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = rep(max(as.POSIXct(da$t, origin = '1970-01-01')), 5)), y = c(60, 70, 80, 90, 100), c("60%", "70%", "80%", "90%", "100%"))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
max(as.POSIXct(da$t, origin = '1970-01-01'))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = rep(max(as.POSIXct(da$t, origin = '1970-01-01')), 5), y = c(60, 70, 80, 90, 100), c("60%", "70%", "80%", "90%", "100%"))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
a=max(as.POSIXct(da$t, origin = '1970-01-01')
)
a
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = a, y = c(60, 70, 80, 90, 100), c("60%", "70%", "80%", "90%", "100%"))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = pos_events[1:5], y = c(60, 70, 80, 90, 100), c("60%", "70%", "80%", "90%", "100%"))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = pos_events, y = 60, label = "60%")
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = pos_events[1], y = 60, label = "60%")
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = pos_events[1], y = c(60, 70, 80, 90, 100), label = "60%")
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
as.POSIXct(da$t, origin = '1970-01-01')
d$t
max(d$t)
typeof(max(d$t))
as.POSIXct(max(d$t))
typeof(as.POSIXct(max(d$t)))
typeof(d$t[1])
str(d$t[1])
str(max(d$t))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(60, 70, 80, 90, 100), label = "60%")
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(60, 70, 80, 90, 100), label = c("60%", "70%", "80%", "90%", "100%"))
#pl1 <- pl1 + guides(color=guide_legend(override.aes=list(shape=c(NA,16),linetype=c(1,0))))
#pl1 <- pl1 + geom_text(data=c(60, 70, 80, 90, 100), label=c("60%", "70%", "80%", "90%", "100%"))
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey70", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey70")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(60, 70, 80, 90, 100), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey70')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl <- ggplot(d, aes(x=t, y=value, color=type)) + geom_point(size=0.1)
pl <- pl + geom_line(size=0.6)
pl <- pl + scale_color_manual(values=c("#4daf4a", "#377eb8"), labels=c("# of STB Tuning In", "# of STB Tuning Out"))
pl <- pl + theme2
pl <- pl + geom_vline(xintercept = num_events, colour = "grey50", size = 0.6)
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey50", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey50")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(60, 70, 80, 90, 100), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
max(da$t)
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(65, 70, 80, 90, 100), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(61, 70, 80, 90, 100), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(size=0.6)
pl1 <- pl1 + scale_color_manual(values="#B13C66", labels="Percentage of Audience")
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey50", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], show.legend = F, size=3, shape=21, colour="grey50")
pl1 <- pl1 + scale_alpha_manual(values="grey70", labels="Beginning of Commercial Break")
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(61, 71, 81, 91, 101), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(mapping = aes(color="#B13C66"), size=0.6)
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey50", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], mapping = aes(color="grey50"), show.legend = F, size=3, shape=21, colour="grey50")
pl1 <- pl1 + scale_color_manual(values=c("#B13C66", "grey50"), labels=c("Percentage of Audience", "Beginning of Commercial Break"))
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(61, 71, 81, 91, 101), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(mapping = aes(color="#B13C66"), size=0.6)
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey50", size = 0.6)
pl1 <- pl1 + geom_point(aes(x=da[events,]$t, y=da[events,]$value, color="grey50"), show.legend = F, size=3, shape=21, colour="grey50")
pl1 <- pl1 + scale_color_manual(values=c("#B13C66", "grey50"), labels=c("Percentage of Audience", "Beginning of Commercial Break"))
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(61, 71, 81, 91, 101), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(mapping = aes(color="#B13C66"), size=0.6)
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey50", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], mapping = aes(color="grey50"), size=3, shape=21, colour="grey50")
pl1 <- pl1 + scale_color_manual(values=c("#B13C66", "grey50"), labels=c("Percentage of Audience", "Beginning of Commercial Break"))
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(61, 71, 81, 91, 101), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
theme1 <- theme(axis.text.y=element_blank(), axis.text.x=element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "grey90", color="grey"),
legend.position = c(0.11, 0.90),
legend.title = element_blank(size=2),
legend.key = element_rect(fill = "grey90", colour = "grey90"),
legend.margin = margin(unit = "cm"),
panel.grid.major = element_line(colour = "grey90", size=0.5, linetype="dashed"),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", color = "grey40", size=0.5),
plot.margin = unit(c(1,1,-0.1,1),"cm")
)
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(mapping = aes(color="#B13C66"), size=0.6)
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey50", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], mapping = aes(color="grey50"), size=3, shape=21, colour="grey50")
pl1 <- pl1 + scale_color_manual(values=c("#B13C66", "grey50"), labels=c("Percentage of Audience", "Beginning of Commercial Break"))
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(61, 71, 81, 91, 101), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
theme1 <- theme(axis.text.y=element_blank(), axis.text.x=element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "grey90", color="grey"),
legend.position = c(0.11, 0.90),
legend.title = element_blank(),
legend.key = element_rect(fill = "grey90", colour = "grey90"),
legend.margin = margin(unit = "cm"),
legend.key.size = 2,
panel.grid.major = element_line(colour = "grey90", size=0.5, linetype="dashed"),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", color = "grey40", size=0.5),
plot.margin = unit(c(1,1,-0.1,1),"cm")
)
theme1 <- theme(axis.text.y=element_blank(), axis.text.x=element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "grey90", color="grey"),
legend.position = c(0.11, 0.90),
legend.title = element_blank(),
legend.key = element_rect(fill = "grey90", colour = "grey90"),
legend.margin = margin(unit = "cm"),
legend.key.size = unit(1, "cm"),
panel.grid.major = element_line(colour = "grey90", size=0.5, linetype="dashed"),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", color = "grey40", size=0.5),
plot.margin = unit(c(1,1,-0.1,1),"cm")
)
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(mapping = aes(color="#B13C66"), size=0.6)
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey50", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], mapping = aes(color="grey50"), size=3, shape=21, colour="grey50")
pl1 <- pl1 + scale_color_manual(values=c("#B13C66", "grey50"), labels=c("Percentage of Audience", "Beginning of Commercial Break"))
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(61, 71, 81, 91, 101), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
theme1 <- theme(axis.text.y=element_blank(), axis.text.x=element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "grey90", color="grey"),
legend.position = c(0.11, 0.90),
legend.title = element_blank(),
legend.key = element_rect(fill = "grey90", colour = "grey90"),
legend.margin = margin(unit = "cm"),
panel.grid.major = element_line(colour = "grey90", size=0.5, linetype="dashed"),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", color = "grey40", size=0.5),
plot.margin = unit(c(1,1,-0.1,1),"cm")
)
pl1 <- ggplot(da, aes(x=t, y=value, color=type))
pl1 <- pl1 + geom_line(mapping = aes(color="#B13C66"), size=0.6)
pl1 <- pl1 + geom_vline(xintercept = 1:100)
pl1 <- pl1 + theme1 + labs(x=NULL)
pl1 <- pl1 + geom_segment(data=da[events,], aes(x=t, xend=t, y=-Inf, yend=value), colour = "grey50", size = 0.6)
pl1 <- pl1 + geom_point(data=da[events,], mapping = aes(color="grey50"), size=3, shape=21, colour="grey50")
pl1 <- pl1 + scale_color_manual(values=c("#B13C66", "grey50"), labels=c("Percentage of Audience", "Beginning of Commercial Break"))
pl1 <- pl1 + annotate("text", x = max(da$t), y = c(61, 71, 81, 91, 101), label = c("60%", "70%", "80%", "90%", "100%"),
color='grey50')
grid.arrange(pl1, pl, ncol=1, nrow=2, heights = c(0.7, 0.3))
